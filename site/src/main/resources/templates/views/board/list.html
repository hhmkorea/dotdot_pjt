<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" layout:decorate="~{layout/default}">
<th:block layout:fragment="title">
    <title>Sophie's Home</title>
</th:block>

<th:block layout:fragment="content">    <!-- /* body.html 중 content 영역에 출력할 조각 */ -->    <!-- /* body.html 중 content 영역에 출력할 조각 */ -->
    <div class="page_tits">
        <h3>게시판</h3>
        <p class="path"><strong>현재 위치 : </strong><span>home</span> <span>게시판</span>
    </div>

    <div class="content">
        <seletion>
            <!-- /* 검색 */ -->
            <div class="search_box">    <!-- /* 검색 디자인 */ -->
                <form id="searchForm" onsubmit="return false;" autocomplete="off">
                    <div class="sch_group fl">
                        <select id="searchType" name="searchType" title="검색 유형 선택">
                            <option value="">전체 검색</option>
                            <option value="title">제목</option>
                            <option value="content">내용</option>
                            <option value="writer">작성자</option>
                        </select>
                        <input type="text" id="keyword" name="keyword" placeholder="키워드를 입력해주세요." title="키워드 입력"/>
                        <button type="button" class="bt_search" onclick="searchBoard()">
                            <img th:src="@{/icons/search.svg}" height="20" th:title="Search" alt="Search"/>
                            <span class="skip_info">검색</span>
                        </button>
                    </div>
                </form>
            </div>

            <!-- /* 리스트 */ -->
            <table class="tb tb_col">   <!-- /* 리스트 페이지 실제 content가 들어가는 영역 */ -->
                <colgroup>
                    <col style="width: 50px;" />
                    <col style="width: 7.5%;" />
                    <col style="width: auto;" />
                    <col style="width: 10%;" />
                    <col style="width: 15%;" />
                    <col style="width: 7.5%;" />
                </colgroup>
                <thead>
                <tr>
                    <th scope="col"><input type="checkbox"/></th>
                    <th scope="col">번호</th>
                    <th scope="col">제목</th>
                    <th scope="col">작성자</th>
                    <th scope="col">등록일</th>
                    <th scope="col">조회</th>
                </tr>
                </thead>

                <!-- /* 리스트 데이터 랜더링 영역 */ -->
                <tbody id="list">
                    <tr th:each="board : ${boards.content}">
                        <td><input type="checkbox" /></td>
                        <td>[[${board.id}]]</td>
                        <td class="tl"><a th:href="@{/board/{id}(id=${board.id})}">[[${board.title}]]</a></td>
                        <td>[[${board.userName}]]</td>
                        <td>[[${board.createDate}]]</td>
                        <td>[[${board.viewCnt}]]</td>
                    </tr>
                </tbody>
            </table>

            <!-- /* 페이지네이션 랜더링 영역 */ -->
            <div class="mt-3">
                <ul class="pagination justify-content-center">

                    <li class="page-item disabled"><a class="page-link" th:if="${boards.first}" th:href="@{|?page=${boards.number - 1}|}"><img th:src="@{/icons/arrow-left.svg}" height="12" title="Previous" alt="Previous"></a></li>
                    <li class="page-item"><a class="page-link" th:unless="${boards.first}" th:href="@{|?page=${boards.number - 1}|}"><img th:src="@{/icons/arrow-left.svg}" height="12" title="Previous" alt="Previous"></a></li>

                    <li class="page-item disabled"><a class="page-link" th:if="${boards.last}" th:href="@{|?page=${boards.number + 1}|}"><img th:src="@{/icons/arrow-right.svg}" height="12" title="Next" alt="Next"></a></li>
                    <li class="page-item"><a class="page-link" th:unless="${boards.last}" th:href="@{|?page=${boards.number + 1}|}"><img th:src="@{/icons/arrow-right.svg}" height="12" title="Next" alt="Next"></a></li>

                </ul>
            </div>
            <!-- /* 버튼 */ -->
            <p class="btn_set tr">
                <a th:href="@{/board/write}" class="btns btn_st5 btn_mid">글쓰기</a>
            </p>
        </seletion>
    </div> <!-- /* .content */ -->
</th:block>
</html>

<script>

    // 페이지 이동
    function searchBoard(page) {

        // 1. 검색 폼
        const form = document.getElementById('searchForm');

        // 2. drawPage( )의 각 버튼에 선언된 onclick 이벤트를 통해 전달받는 page(페이지 번호)를 기준으로 객체 생성
        const queryParams = {
            page: (page) ? page : 1,
            recordSize: 10,
            pageSize: 10,
            searchType: form.searchType.value,
            keyword: form.keyword.value
        }

        /*
         * 3. location.pathname : 리스트 페이지의 URI("/board/list")를 의미
         *    new URLSearchParams(queryParams).toString() : queryParams의 모든 프로퍼티(key-value)를 쿼리 스트링으로 변환
         *    URI + 쿼리 스트링에 해당하는 주소로 이동
         *    (해당 함수가 리턴해주는 값을 브라우저 콘솔(console)에 찍어보시면 쉽게 이해하실 수 있습니다.)
         */
        console.log(queryParams);
        debugger;
        location.href = location.pathname + '?' + new URLSearchParams(queryParams).toString();
    }

</script>
